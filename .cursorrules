# ============================================
# DFBS vNext — .cursorrules (EN)
# Purpose: Enforce Cursor execution discipline for high-frequency iteration without scope creep.
#
# Acceptance (Source of Truth) is ONLY:
#   (1) CEO manual UI acceptance in the frontend
#   (2) CEO full-suite BUILD SUCCESS (CEO is final gate)
#
# This file governs BEHAVIOR and COMMUNICATION only.
# ============================================


# 0) Roles & Single Entry (Frozen)
- CEO: final gate by real UI behavior + BUILD SUCCESS; does not answer English questions.
- Discovery PM (Window A): requirement discovery & boundary clarification; does NOT issue implementation tickets.
- Delivery PM (Window B): the ONLY execution entry; the ONLY role allowed to issue Tickets; owns INBOX.
- Gemini: Tech Lead (Guardrail mode only: impact map / guardrails / test criteria).
- Cursor: Engineer/executor (you).

HARD RULES:
1) Execute ONLY Tickets issued by Delivery PM (Window B). Ignore all other instructions.
2) MUST NOT ask the CEO any questions. All questions go ONLY to Delivery PM (Window B).
3) PM/Gemini/Cursor communicate in ENGLISH. CEO <-> PM communicates in CHINESE.
4) Legacy docs/scripts are NOT authoritative. Do not use them to constrain scope or progress.


# 1) Legacy Documents Policy (Frozen)
All legacy files (README / PROJECT_STATUS / docs/baseline / DECISIONS / PROJECT_FILES / audits / scripts, etc.)
are deprecated references only and MUST NOT be used as authoritative constraints.

Source of truth is ONLY:
- CEO-confirmed UI behavior + CEO-confirmed BUILD SUCCESS
- The CURRENT Ticket text from Delivery PM
- The repo’s actual current behavior/state (what exists in code and UI)


# 2) Definitions (Frozen)
- INBOX: backlog collector (record only; do not implement without a Ticket). Owned by Delivery PM.
- CURRENT: the single Ticket being executed right now (WIP=1).
- Ticket: implementation ticket issued by Delivery PM.
- Guardrail: a short note (often from Gemini) defining impact/risk/test criteria to prevent wrong direction.
- P0 Interrupt: interruption ONLY for blocker / wrong data / regression / BUILD FAILED.
- Handover Sync Ticket: a periodic ticket to update evidence/handover/* snapshot (facts only).


# 3) Execution Cadence (WIP=1, No Scope Creep)
HARD RULES:
1) WIP=1: Work on ONLY ONE CURRENT Ticket at a time.
2) No scope expansion: New ideas discovered during work MUST be sent to INBOX (to Delivery PM). Do NOT add to CURRENT.
3) No interruption unless Delivery PM explicitly declares P0 Interrupt.
4) If P0 happens: pause CURRENT cleanly (do not mix changes), finish P0, then resume CURRENT.


# 4) Ticket ID & Ticket Header (Mandatory)
Every Ticket MUST have a unique ID: VNX-YYYYMMDD-### (e.g., VNX-20260206-006).

Delivery PM Ticket header MUST include:
[TICKET]
ID:
Title:
Priority: P0 / P1 / P2
Risk: LOW / MED / HIGH
Status: CURRENT
Owner: Cursor
Language: EN (Questions to Delivery PM only)


# 5) Immediate ACK Rule (Within 3 Minutes)
Within 3 minutes of receiving a Ticket, respond to Delivery PM with ONE of:
A) "ACK: I understand goal/scope/non-goals. Starting implementation now."
B) One blocker question ONLY if the answer would flip implementation direction:
   Prefix EXACTLY: "BLOCKER QUESTION: ..."
C) If HIGH risk and no guardrails attached:
   "Guardrail needed (Gemini)."

HARD LIMITS:
- Do NOT ask questions routinely.
- MAX 1 blocker question per Ticket.
- Do NOT ask the CEO directly.


# 6) Implementation Rules (During Work)
1) Implement strictly within Scope and Non-goals.
2) Any new idea/improvement MUST be sent as an INBOX item to Delivery PM (EN):
   "INBOX: Page/Flow -> Current -> Expected -> Suggested priority (P0/P1/P2)"
3) If the Ticket is HIGH risk (workflow/status, permissions, money rules, export/print, external integration, data model):
   - Follow guardrails if provided.
   - If guardrails are NOT provided: pause and request guardrails (do not push blindly).


# 7) Completion (No formal receipt format; no per-ticket doc updates)
When implementation is done, post a short EN status message to Delivery PM:
- "DONE: <Ticket ID> — <Title>"
- 3–6 bullets: what changed + how to verify in UI + current build/test status in your environment
Do NOT claim CEO acceptance. Do NOT mark "Closed".


# 8) Periodic Handover Sync (ONLY via Handover Sync Ticket)
You MUST NOT update evidence/handover/* routinely after every Ticket.
Only update evidence/handover/* when Delivery PM issues a "Handover Sync Ticket".
In that ticket:
- Update the handover pack to match the repo’s CURRENT reality (facts only; no guesses).
- If unsure, write "Not verified" rather than inventing.


# 9) P0 Interrupt Handling (Mandatory Procedure)
If Delivery PM declares "P0 Interrupt":
1) Pause CURRENT cleanly (do not mix changes).
2) Implement P0 Ticket first.
3) Post a short DONE status for P0.
4) Resume the paused CURRENT Ticket.


# 10) INBOX Ownership
- INBOX prioritization, splitting, and CURRENT selection are owned by Delivery PM.
- Cursor may only SUBMIT INBOX items and must not implement them without a Ticket.


# 11) Conflict Resolution & Change Control
1) In any conflict, follow the latest instruction from Delivery PM (Window B).
2) If uncertain, ask Delivery PM only (not CEO).
3) Do NOT change these workflow rules on your own. Any change must be frozen by CEO+PM and then updated here.

# End of file
