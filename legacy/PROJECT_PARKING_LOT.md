# PROJECT_PARKING_LOT.md（需求停车场｜追加式清单）

> 用途：记录“讨论很清楚，但为了整体推进先不做/暂不做”的需求，避免以后重新聊。
> 基本规则：只追加；每条给一个 ID；写清“暂不做原因”和“未来验收口径”。
> 追加规则（最新）：
> - 正在执行：不移除，可将状态标记为 IN_PROGRESS
> - 已完成：不移除，将状态标记为 DONE（可附里程碑ID）
> - 禁止删除历史条目（保持留痕）

## 待补录清点区（来自旧讨论，暂不进入开发）
规则：先记录，不争论；等成为“唯一推进点”再做 Interview → Logic Freeze → Dev&Test。

- YYYY-MM-DD：一句话（你想到什么就写什么）
  - 你担心的风险/原因：
  - 你希望的结果：
  - 当前状态：待补录

---

## 记录格式（固定）

### [ID] 标题
- 状态：PARKED（暂不做）/ READY（随时可做）/ IN_PROGRESS（正在执行）/ DONE（已实现）
- 暂不做原因：一句话说明为什么这轮不做
- 业务口径（冻结）：把规则写清楚（不写代码）
- 未来验收口径：User 怎么判断“做对了”

---

## 已停车条目

### [QI-CFG-001] QuoteItem：费用类型/费用描述/单位 的“管理员可配置”
- 状态：PARKED
- 暂不做原因：本轮先跑通 QuoteItem 最小闭环，避免卡在配置后台与权限上
- 业务口径（冻结）：
  - 费用类型：目前有固定类型（如维修费/上门费/配件费/平台费/流量费/仓储费/运输费/包装费/施工费等）
  - 未来需要：管理员可新增类型、可改名、可停用
  - 费用描述：不是自由文本；是下拉；且“不同费用类型的下拉选项不同”；管理员可配置/修改
  - 单位：不同费用类型单位不同（配件=个；平台费=点；流量=月/年；其他=次等），未来由管理员维护
- 未来验收口径：
  - 能维护“费用类型字典”
  - 能维护“费用描述字典”，并支持按费用类型分组
  - QuoteItem 选择费用类型后，费用描述下拉随之变化
  - 单位能随费用类型自动推荐/限制

### [QI-AUTO-001] QuoteItem：配件类自动带出 BOM 图号（规格型号）
- 状态：PARKED
- 暂不做原因：依赖 BOM 与“机型+配件名称”的联动查询，本轮先不引入复杂依赖
- 业务口径（冻结）：
  - 当费用类型=配件费：
    - 费用描述=配件名称（可选）
    - 规格型号=配件图号（来自 BOM）
    - 规则：按“机型 + 配件名称”自动带出
- 未来验收口径：
  - 选机型+配件名称后，规格型号自动出现且正确

### [QI-AUTO-002] QuoteItem：平台费自动带出机构代码（规格型号）
- 状态：PARKED
- 暂不做原因：机构代码来源与关联规则需单独确认，先不阻塞 QuoteItem 闭环
- 业务口径（冻结）：
  - 当费用类型=平台费：
    - 规格型号字段填写“机构代码”
    - 未来希望能自动带出
- 未来验收口径：
  - 平台费行能自动带出机构代码，且可追溯来源

### [QI-CUSTOM-001] QuoteItem：预留至少 10 个自定义字段（后续启用）
- 状态：PARKED
- 暂不做原因：先预留结构/不启用 UI，避免本轮 UI 与导出复杂化
- 业务口径（冻结）：
  - 至少 10 个自定义字段（后续由管理员启用/命名/决定类型）
- 未来验收口径：
  - 管理员可启用字段并配置名称/类型
  - QuoteItem 表单能显示这些字段并保存导出

### [QUOTE-DICT-001] 报价单字段“确认前可临时输入，CONFIRMED 必须归一到字典项”扩展
- 状态：PARKED
- 暂不做原因：会牵涉字典/权限/确认校验链路，本轮先不扩大范围
- 业务口径（冻结）：
  - 除“银行信息、办事处”外，报价单其它字段尽量支持：确认前可临时手填；CONFIRMED 时必须替换为系统字典/主数据选项
  - 缺失时：由有权限的人新增字典项后再确认
- 未来验收口径：
  - CONFIRMED 时强制归一（无字典项不能确认）
  - 有权限的人可新增字典项后继续确认

### [BOM-001] 完整 BOM（机型→配件清单）关系
- 状态：PARKED
- 暂不做原因：会引入配件库/机型BOM维护与联动推荐，本轮先不引入复杂依赖
- 业务口径（冻结）：
  - 每个机型可维护配件清单
  - 工单发起报价单时可按机型/工单配件自动带出候选
  - CONFIRMED 时配件必须归一到配件库/机型BOM
- 未来验收口径：
  - 选机型后能推荐配件清单
  - CONFIRMED 时配件可追溯到 BOM/配件库

### [PAYFLOW-001] 报价单回款确认流程（执行人填回款信息 → 财务确认已回款）
- 状态：DONE（里程碑ID：以 PROJECT_STATUS.md 为准）
- 暂不做原因：无（已完成）
- 业务口径（冻结）：
  - 工作流：提交 → 财务审核（通过/驳回）→ 财务指派收款人 → 收款人录入 → 财务确认到账
  - 安全：收款人录入默认未确认；仅财务“确认到账”后才扣减未收金额
  - 自动判定：支持部分回款/已回款状态自动更新
  - 追溯：每一步操作有记录（操作人/时间/原因/状态变化）
- 未来验收口径：
  - Tests Passed（详见对应里程碑）
- 状态：DONE（里程碑ID：2026-01-28-01）

### [CC-WH-001] 发件报价单抄送仓库
- 状态：DONE（里程碑ID：2026-01-27-02）
- 暂不做原因：无（已完成）
- 业务口径（冻结）：
  - 满足“总部仓库明细”条件时抄送仓库；财务确认后提醒发货；去重
- 未来验收口径：
  - Tests Passed（详见对应里程碑）

### [INVOICE-001] 报价单发票申请分支流程（含合并/拆分）
- 状态：DONE（里程碑ID：以 PROJECT_STATUS.md 为准）
- 暂不做原因：无（已完成）
- 业务口径（冻结）：
  - 支持从报价单发起开票申请；支持多张报价单合并申请
  - 支持在一次申请内按税率/类型把费用项拆分到不同“发票组”
  - 金额风控：本次申请金额 + 已开票金额 <= 报价单总额（禁止超额）
  - 币种一致：合并开票的报价单币种必须一致
  - 审批：提交 → 财务审批 → 结果通知；同意后累计已开票金额并更新开票状态；驳回允许重提
- 未来验收口径：
  - Tests Passed（详见对应里程碑）
- 状态：DONE（里程碑ID：2026-01-28-03）

### [PAY-MERGE-001] 同一客户多张报价单合并回款（月结/对账）
- 状态：DONE（里程碑ID：以 PROJECT_STATUS.md 为准）
- 暂不做原因：无（已完成）
- 业务口径（冻结）（按当前实现修正）：
  - 使用人：收款执行人
  - 入口：收款执行人“待回款清单”多选报价单 → 合并回款
  - 限制条件（必须同时满足）：
    1) 同一客户
    2) 同一收款执行人
    3) 币种一致（且与各报价单币种一致）
    4) 只能选“未付清/未收=0 以外”的单据（即未收>0）
    5) 合并回款金额必须严格等于【所选报价单未收金额之和】（多一分少一分都拦截，并提示差额）
  - 记录方式：
    - 一次打款生成 N 条回款记录，并用 paymentBatchNo 关联为同一批次
    - 默认未确认，不绕过财务确认到账
- 未来验收口径：
  - Tests Passed（详见对应里程碑）
- 状态：DONE（里程碑ID：2026-01-28-02）

  ### [EXP-CLAIM-001] 费用报销（Claim）流程（业务未定，先停车）
- 状态：PARKED
- 暂不做原因：CEO 尚未想好“报销申请/审批/退回/作废”等完整业务流程
- 备注：
  - 基准文件要求：费用 & 报销 & 简单统计 属于 V1 必做（但本条先停车，避免需求不清导致返工）
  - 后续需要你补齐的关键点（到时候再问，不提前追问）：
    - 报销的参与角色：谁发起、谁审批、是否多级审批
    - 是否允许：撤回/退回后修改再提交/作废/部分通过
    - 报销与“费用事实”的关系：一次报销可勾选哪些费用、是否必须同一人/同一客户/同一时间段
    - 审批通过后的动作：仅记录？还是需要触发“支付/入账”等（若不做也要明确）


