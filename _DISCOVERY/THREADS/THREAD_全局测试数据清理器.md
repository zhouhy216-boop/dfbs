# THREAD：全局测试数据清理器（开发期效率轮子）
状态：已冻结 v1（准备开干）
目的：开发/验收阶段反复测试时，一键或按模块清理测试数据，减少“数据越测越脏”的沟通与操作成本。

---

## 1) CEO 想要的最终效果（人话）
- 右上角用户名旁边有入口：**测试工具 → 清空测试数据**
- 只有 **admin 账号**看得到/用得了；未来上线时可以隐藏/关闭入口（不需要现在纠结“环境怎么定义”）
- 点进去弹窗：
  - 有 **一键预设**（最常用）
  - 也能 **自定义多选**（想清哪里清哪里）
  - 勾选时系统会 **自动补全依赖**（避免清一半变“半残”）
  - 清之前能 **预览将清多少条**（心里有数）
  - 清完给一个 **清理报告**（清了哪些、各多少条、时间戳）

---

## 2) 已冻结的 v1 口径（不再反复讨论）
### 2.1 入口与权限
- 入口位置：用户名旁边 / 用户下拉菜单内
- 名称：测试工具 → 清空测试数据
- 可见性：仅 admin 可见可用
- 上线策略：提供开关隐藏/关闭（v1 先保留可用；上线前你手动关）

### 2.2 预设与多选
弹窗包含两块：

A) 一键预设（建议至少提供）
1) 清空全部业务数据（推荐）
2) 只清当前模块数据（用户在哪个模块打开，就只清该模块）
3) 只清记录类（操作记录/审计/变更记录/通知消息）

B) 自定义多选
- 按模块分组勾选：工单/报价/申请/发货委托/平台/物联网卡/仓库/物流… + 记录类 +（可选）附件

### 2.3 清空范围三项关键决策（已确认）
1) “清空全部业务数据” **包含组织架构数据**（选 1.A）
2) **附件默认不清**（选 2.B）：只有在自定义多选里勾了“附件”才清
3) 不做“只清我创建的数据”（选 3.B）

### 2.4 依赖自动补全（已确认）
- 用户勾选某项时，系统会自动勾上它的必要依赖（例如清“人员”会自动带上“人员归属/职位绑定”等），避免清完系统处于不可用/半残状态。

### 2.5 确认护栏（不烦但防手滑）
- 小范围清理：二次确认即可
- 大范围/全清：增加输入 `RESET` + 再确认一次“不可恢复”
- 清空后自动恢复“最小可测状态”（例如至少保证页面不至于完全空白影响继续测试）

### 2.6 默认不清的底座（防炸系统）
默认不清：
- 账号/权限
- 数据字典（未来会越来越重要）
- 各类模板库（打印模板/通知模板等“模板本身”）
- 职位库 catalog、职级字典（如果已作为底座使用）

---

## 3) v1 建议的验收口径（给你快速判断做对没）
1) admin 登录后，用户名旁边可看到「测试工具 → 清空测试数据」
2) 打开弹窗能看到：一键预设 + 自定义多选
3) 勾选时会自动补全依赖（不会让你清出半残）
4) 清理前能预览：将清理多少条数据（至少核心模块有数字）
5) “清空全部业务数据”会包含组织架构数据；但不会动账号/权限/字典/模板库
6) 附件默认不会被“全清”清掉；只有你手动勾选附件才会清
7) 清理完成会给清理报告（模块 + 条数 + 时间戳）

---

## 4) 未确认（Unknown，后续如果卡再补）
- “当前模块”如何判定（按当前路由/页面，还是按左侧菜单模块）
- 全量模块清单与命名（工单/报价/物流/平台/物联网卡/仓库/申请/发货委托等最终在系统里的分组名）
- 清理后“最小可测状态”的具体内容（例如是否自动创建一条示例数据/只保留公司根节点等）

---
