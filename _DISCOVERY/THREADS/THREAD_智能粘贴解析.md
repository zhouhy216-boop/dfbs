# THREAD：智能粘贴解析（Smart Paste Parsing）
状态：暂停（原因：先把发货/委托等核心表单做出来并稳定，再做字段映射与解析扩展）

## 0) 这条 THREAD 的目的（给未来的我/你）
- 记录“智能粘贴解析”已讨论并冻结的部分，避免下次从头聊、避免重复提问。
- 下次继续时，只围绕【未确认】和【待实物】推进；【已冻结】不再反复确认。

---

## 1) 已冻结（不再反复讨论）
### 1.1 目标与定位
- 目标：减轻填写发货/委托等复杂表单的工作量。
- 允许填错：不追求零错误；填写人负责核对再提交（这是“提效功能”，不是自动决策）。
- 推进策略：先在“发货/委托”两处做稳能用，再向其他页面扩展。

### 1.2 触发方式与整体体验
- 触发：用户点击按钮“智能解析”才解析（不是自动触发）。
- 不要弹窗：解析后直接把内容填进表单，用户再自行修改确认。
- 需要对比：页面固定位置展示粘贴内容，方便对照核对（对比区具体展示形态未最终冻结）。

### 1.3 粘贴内容形态（用户真实会粘贴的内容）
- 来源可能是：网页 / 微信聊天 / 邮件 / Excel 复制。
- 形态可能包括：
  - 表格文本（带表头、多列、可多行）
  - 极简一行（例如：姓名 电话 地址）
  - 其他：未确认（后续以样本为准）

### 1.4 多段信息与顺序规律
- 同一段粘贴内容可能包含两段信息：
  - 常见：发货方信息在前，收货方信息在后
  - 也可能只包含发货方或只包含收货方（根据委托内容而定）

### 1.5 委托相关的业务概念
- 委托信息里：不存在“委托方”，只有“委托类型/分类”。
- 委托类型来自粘贴内容（不是用户必填固定枚举输入）。
- 希望系统能根据粘贴内容格式自动判断：这是“委托信息”还是“发货信息”，并识别委托类型。
- 委托类型有规律（用户举例：展会发货、展会返回、测试机发货、测试机返回、验证机发货、验证机返回、借用机发货、借用机返货、客户委托、借用机移机……；完整清单未冻结）。
- 委托类型会影响默认归位规则（例如“工厂”默认是发货方或收货方，以及粘贴内容主要补哪一侧信息）。典型举例：
  - “展会发货”：默认发货方=工厂；粘贴内容主要是收货方信息 + 机型/台数等
  - “借用及返回”：默认收货方=工厂（其余规则待样本与表单字段冻结）

---

## 2) 已提供的真实样本（可直接复用）
### 2.1 发货单最终结果样例（用于理解目标字段，但不是粘贴输入）
- kintone 记录示例（记录ID 274）：包含合同号、客户简称/代码、销售担当、希望发货日、接货人/电话、到货省/城市/详细地址、备注、以及“发货依赖明细（产品型号/名称/台数/包装方式）”等。

### 2.2 用户可能粘贴的内容样例（这是智能解析的输入）
样例A（表格/表头形式）：
- “智尚订单编号 / 分部 / 订单日期 / 厂家 / 具体型号 / 型号编码 / 贴纸颜色 / 单位 / 数量 / 发往地址 / 收货人 / 收货人联系方式 / 到货日期 / 订单备注 …”
- 示例值：订单号 ZSVP2601-0029，数量 4，地址 江苏无锡曲火供应链有限公司，收货人 刘大国，电话 18761224758，到货日期 2026-2-9 等。

样例B（极简一行）：
- “刘大国  18761224758 江苏无锡曲火供应链有限公司”

---

## 3) 未确认（下次继续从这里推进）
> 以下全部标注为 Unknown/未确认，禁止脑补；必须依赖“实物”来冻结口径。

### 3.1 表单与字段映射（核心未确认）
- 发货表单最终字段清单（字段名+含义）尚未整理完成。
- 委托表单最终字段清单（字段名+含义）尚未整理完成。
- 工单表单字段清单（字段名+含义）尚未提供。
- 解析后的字段映射规则：每种粘贴形态/每种委托类型如何写入哪些字段。

### 3.2 委托类型的完整规则
- 委托类型完整列表（名称、别名/关键词、典型文本格式）。
- 每种委托类型的默认归位规则（工厂在发货/收货哪一侧、默认填哪些块、哪些内容应进备注等）。

### 3.3 产品型号/编码对照
- 是否存在“型号编码/中文描述 → 系统产品型号（如 FVM-xxx）”的对照来源（主数据/表/接口）。
- 若无对照来源：默认策略如何（例如：先填中文描述与数量，编码/其他信息入备注）。

### 3.4 对比区与“自动填”的细则
- 对比区最终展示：仅原文 vs 原文+结构化摘要（未冻结）。
- 自动填策略：用户手动改过字段后，再次解析/切换委托类型时如何处理（不覆盖/部分覆盖/保留手改优先等）。
- “识别为委托/发货”的纠错方式：是否允许用户手动切换类型（倾向允许，但未冻结细节）。

---

## 4) 下次继续讨论前需要的“实物”（必须）
> 原则：缺实物不推进，不猜。

1) 发货表单：字段清单（字段名 + 一句话解释）
2) 委托表单：字段清单（字段名 + 一句话解释，含“委托类型”字段）
3) 工单表单：字段清单（字段名 + 一句话解释）
4) 粘贴样本：至少 30 条（更稳：50+），每条标注来源（网页/微信/邮件/Excel）与“这是发货/委托/工单中的哪一种”
5) 委托类型清单：完整列表 + 每种类型 1–2 条典型粘贴样本（若暂时给不全，先给最常用的 3–5 种）

---

## 5) 下次续聊的切入点（我应该怎么推进，避免重复劳动）
- Step 1：基于发货/委托字段清单，先给出“解析结果 → 字段映射草案”（只做映射与用户体验，不谈实现）
- Step 2：冻结“委托类型 → 默认归位规则”
- Step 3：用样本跑一轮“覆盖检查”：哪些样本能全自动填、哪些只能半自动、哪些需要新增字段或新增类型规则
- Step 4：确认扩展路线：在发货/委托稳定后，再扩展到其他模块（申请/工单等）
